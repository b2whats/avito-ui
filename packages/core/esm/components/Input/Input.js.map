{"version":3,"sources":["../../../src/components/Input/Input.tsx"],"names":["React","isValidElement","useState","useUncontrolledInputHook","useSyntheticChange","foldThemeParams","createClassName","uiComponent","clearValue","invokeAll","Text","InputCore","inputTheme","inputClassName","themeStyle","props","display","width","textRules","inputFieldClassName","valign","grow","Input","onFocus","onBlur","mask","theme","tokens","inputRef","setRef","renderCore","p","focus","setFocus","safeValue","safeOnChange","value","onChange","clearable","Boolean","disabled","readOnly","iconAfter","placeholder","deletePlaceholderOnFocus","handleFocus","handleBlur","handlePreventBlur","event","target","current","preventDefault","handleClear","IconBefore","IconAfter","InputField","Prefix","Postfix","inputStyle","style","inputFieldStyle","renderIconSlot","icon","iconProps","undefined","textColor","activeColor","placeholderColor","renderTextSlot","text","textProps","color","component","onClick","elementState","iconBefore","prefix","autoSize","postfix","ref"],"mappings":"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","sourcesContent":["import React, { isValidElement, useState } from 'react'\nimport { useUncontrolledInputHook, useSyntheticChange } from '../../hooks/'\nimport { foldThemeParams, createClassName } from '../../styled-system/'\nimport { uiComponent } from '../../theme/'\nimport { clearValue, invokeAll } from '../../utils/'\nimport { IconProps } from '../Icon/'\nimport { Text, TextProps } from '../Text/'\nimport { InputProps } from './contract'\nimport { InputCore } from './InputCore'\nimport { inputTheme } from './theme'\n\nconst inputClassName = createClassName<InputProps, typeof inputTheme>(\n  (themeStyle, props) => ({\n    display: 'flex',\n    width: 1,\n    ...themeStyle,\n    ...props,\n  }),\n  (textRules) => (`\n    position: relative;\n    font-family: inherit;\n    align-items: center;\n\n    ${textRules}\n  `)\n)\n\nconst inputFieldClassName = createClassName<InputProps, typeof inputTheme>(\n  (themeStyle) => ({\n    display: 'flex',\n    valign: 'middle',\n    grow: true,\n    ...themeStyle,\n  }),\n  (textRules) => (`\n    height: 100%;\n    overflow: hidden;\n\n    ${textRules}\n  `)\n)\n\nexport const Input = uiComponent('Input', inputTheme)<InputProps, HTMLInputElement>((\n  { onFocus, onBlur, mask, ...props },\n  { theme, tokens },\n  [inputRef, setRef]\n) => {\n  const renderCore = props.renderCore || (p => <InputCore {...p} />)\n  const [focus, setFocus] = useState(false)\n  const [safeValue, safeOnChange] = useUncontrolledInputHook(props)\n  const [value, onChange] = useSyntheticChange(safeValue, safeOnChange, mask)\n  const clearable = Boolean(\n    value &&\n    !props.disabled && !props.readOnly &&\n    (props.clearable === 'always' || props.clearable && focus))\n\n  props = {\n    ...props,\n    value,\n    clearable,\n    // apply iconAfter theme if clearable\n    iconAfter: clearable ? true : props.iconAfter,\n    placeholder: inputTheme.deletePlaceholderOnFocus && focus ? '' : props.placeholder,\n  }\n\n  const handleFocus = invokeAll(() => setFocus(true), onFocus)\n  const handleBlur = invokeAll(() => setFocus(false), onBlur)\n\n  // Отменяем моргание фокуса при повторных кликах внутри контейнера с инпутом\n  // Проверка нужна что бы не блокировать выделениие в самом инпуте\n  const handlePreventBlur = (event: React.MouseEvent<HTMLElement>) => {\n    if (event.target !== inputRef.current) event.preventDefault()\n  }\n\n  const handleClear = () => clearValue(inputRef.current)\n\n  const { Input, IconBefore, IconAfter, InputField, Prefix, Postfix } = foldThemeParams(props, theme)\n  const inputStyle = inputClassName(props, tokens, Input.style)\n  const inputFieldStyle = inputFieldClassName(props, tokens, InputField.style)\n\n  const renderIconSlot = (icon: InputProps['iconBefore'] | InputProps['iconAfter'], iconProps: IconProps) => (\n    typeof icon === 'function' ? icon({ ...props, iconProps, focus, handleClear }) :\n    isValidElement(icon) ? <icon.type {...iconProps} {...icon.props} /> :\n    undefined\n  )\n\n  const textColor = (activeColor?: any) => focus || props.value ? activeColor : Input.style.placeholderColor\n  const renderTextSlot = (text: InputProps['prefix'] | InputProps['postfix'], textProps: TextProps) => (\n    typeof text === 'string' ? <Text {...textProps} color={textColor()} pre>{text}</Text> :\n    typeof text === 'function' ? text({ ...props, focus }) :\n    React.isValidElement(text) ? <text.type {...textProps} {...text.props} color={textColor(text.props.color)} /> :\n    undefined\n  )\n\n  const iconAfter = renderIconSlot(\n    IconAfter.component ? <IconAfter.component /> : props.iconAfter,\n    clearable ? { ...IconAfter.props, onClick: handleClear } : IconAfter.props\n  )\n\n  const elementState = `${props.disabled ? 'disabled' : ''} ${focus ? 'focus' : ''}`\n\n  return (\n    // eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions\n    <label css={inputStyle} data-state={elementState} onMouseDown={handlePreventBlur}>\n      {props.iconBefore && renderIconSlot(props.iconBefore, IconBefore.props)}\n      <div css={inputFieldStyle}>\n        {props.prefix && renderTextSlot(props.prefix, Prefix.props)}\n        {renderCore({\n          ...props,\n          onChange,\n          autoSize: Boolean(props.postfix),\n          ref: setRef,\n          onFocus: handleFocus,\n          onBlur: handleBlur,\n        })}\n        {props.postfix && renderTextSlot(props.postfix, Postfix.props)}\n      </div>\n      {iconAfter}\n\n    </label>\n  )\n})\n"],"file":"Input.js"}