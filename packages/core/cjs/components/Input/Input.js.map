{"version":3,"sources":["../../../src/components/Input/Input.tsx"],"names":["inputClassName","themeStyle","props","display","width","textRules","inputFieldClassName","valign","grow","Input","inputTheme","onFocus","onBlur","mask","theme","tokens","inputRef","setRef","renderCore","p","focus","setFocus","safeValue","safeOnChange","value","onChange","clearable","Boolean","disabled","readOnly","iconAfter","placeholder","deletePlaceholderOnFocus","handleFocus","handleBlur","handlePreventBlur","event","target","current","preventDefault","handleClear","IconBefore","IconAfter","InputField","Prefix","Postfix","inputStyle","style","inputFieldStyle","renderIconSlot","icon","iconProps","undefined","textColor","activeColor","placeholderColor","renderTextSlot","text","textProps","isValidElement","color","component","onClick","elementState","iconBefore","prefix","autoSize","postfix","ref"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA;;AAEA;;AAEA;;AACA;;;;AAEA,IAAMA,cAAc,GAAG,mCACrB,UAACC,UAAD,EAAaC,KAAb;AAAA;AACEC,IAAAA,OAAO,EAAE,MADX;AAEEC,IAAAA,KAAK,EAAE;AAFT,KAGKH,UAHL,EAIKC,KAJL;AAAA,CADqB,EAOrB,UAACG,SAAD;AAAA,oGAKIA,SALJ;AAAA,CAPqB,CAAvB;AAgBA,IAAMC,mBAAmB,GAAG,mCAC1B,UAACL,UAAD;AAAA;AACEE,IAAAA,OAAO,EAAE,MADX;AAEEI,IAAAA,MAAM,EAAE,QAFV;AAGEC,IAAAA,IAAI,EAAE;AAHR,KAIKP,UAJL;AAAA,CAD0B,EAO1B,UAACI,SAAD;AAAA,gEAIIA,SAJJ;AAAA,CAP0B,CAA5B;AAeO,IAAMI,KAAK,GAAG,wBAAY,OAAZ,EAAqBC,kBAArB,EAA+D,8BAI/E;AAAA,MAHDC,OAGC,QAHDA,OAGC;AAAA,MAHQC,MAGR,QAHQA,MAGR;AAAA,MAHgBC,IAGhB,QAHgBA,IAGhB;AAAA,MAHyBX,KAGzB;AAAA,MAFDY,KAEC,SAFDA,KAEC;AAAA,MAFMC,MAEN,SAFMA,MAEN;AAAA,MADFC,QACE;AAAA,MADQC,MACR;;AACH,MAAMC,UAAU,GAAGhB,KAAK,CAACgB,UAAN,IAAqB,UAAAC,CAAC;AAAA,WAAI,eAAC,oBAAD,EAAeA,CAAf,CAAJ;AAAA,GAAzC;;AADG,kBAEuB,qBAAS,KAAT,CAFvB;AAAA,MAEIC,KAFJ;AAAA,MAEWC,QAFX;;AAAA,8BAG+B,qCAAyBnB,KAAzB,CAH/B;AAAA,MAGIoB,SAHJ;AAAA,MAGeC,YAHf;;AAAA,4BAIuB,+BAAmBD,SAAnB,EAA8BC,YAA9B,EAA4CV,IAA5C,CAJvB;AAAA,MAIIW,KAJJ;AAAA,MAIWC,QAJX;;AAKH,MAAMC,SAAS,GAAGC,OAAO,CACvBH,KAAK,IACL,CAACtB,KAAK,CAAC0B,QADP,IACmB,CAAC1B,KAAK,CAAC2B,QAD1B,KAEC3B,KAAK,CAACwB,SAAN,KAAoB,QAApB,IAAgCxB,KAAK,CAACwB,SAAN,IAAmBN,KAFpD,CADuB,CAAzB;AAKAlB,EAAAA,KAAK,iCACAA,KADA;AAEHsB,IAAAA,KAAK,EAALA,KAFG;AAGHE,IAAAA,SAAS,EAATA,SAHG;AAIH;AACAI,IAAAA,SAAS,EAAEJ,SAAS,GAAG,IAAH,GAAUxB,KAAK,CAAC4B,SALjC;AAMHC,IAAAA,WAAW,EAAErB,mBAAWsB,wBAAX,IAAuCZ,KAAvC,GAA+C,EAA/C,GAAoDlB,KAAK,CAAC6B;AANpE,IAAL;AASA,MAAME,WAAW,GAAG,sBAAU;AAAA,WAAMZ,QAAQ,CAAC,IAAD,CAAd;AAAA,GAAV,EAAgCV,OAAhC,CAApB;AACA,MAAMuB,UAAU,GAAG,sBAAU;AAAA,WAAMb,QAAQ,CAAC,KAAD,CAAd;AAAA,GAAV,EAAiCT,MAAjC,CAAnB,CApBG,CAsBH;AACA;;AACA,MAAMuB,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,KAAD,EAA0C;AAClE,QAAIA,KAAK,CAACC,MAAN,KAAiBrB,QAAQ,CAACsB,OAA9B,EAAuCF,KAAK,CAACG,cAAN;AACxC,GAFD;;AAIA,MAAMC,WAAW,GAAG,SAAdA,WAAc;AAAA,WAAM,uBAAWxB,QAAQ,CAACsB,OAApB,CAAN;AAAA,GAApB;;AA5BG,yBA8BmE,mCAAgBpC,KAAhB,EAAuBY,KAAvB,CA9BnE;AAAA,MA8BKL,KA9BL,oBA8BKA,KA9BL;AAAA,MA8BYgC,UA9BZ,oBA8BYA,UA9BZ;AAAA,MA8BwBC,SA9BxB,oBA8BwBA,SA9BxB;AAAA,MA8BmCC,UA9BnC,oBA8BmCA,UA9BnC;AAAA,MA8B+CC,MA9B/C,oBA8B+CA,MA9B/C;AAAA,MA8BuDC,OA9BvD,oBA8BuDA,OA9BvD;;AA+BH,MAAMC,UAAU,GAAG9C,cAAc,CAACE,KAAD,EAAQa,MAAR,EAAgBN,KAAK,CAACsC,KAAtB,CAAjC;AACA,MAAMC,eAAe,GAAG1C,mBAAmB,CAACJ,KAAD,EAAQa,MAAR,EAAgB4B,UAAU,CAACI,KAA3B,CAA3C;;AAEA,MAAME,cAAc,GAAG,SAAjBA,cAAiB,CAACC,IAAD,EAA2DC,SAA3D;AAAA,WACrB,OAAOD,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,+BAAMhD,KAAN;AAAaiD,MAAAA,SAAS,EAATA,SAAb;AAAwB/B,MAAAA,KAAK,EAALA,KAAxB;AAA+BoB,MAAAA,WAAW,EAAXA;AAA/B,OAAjC,GACA,wCAAeU,IAAf,IAAuB,eAAC,IAAD,CAAM,IAAN,gCAAeC,SAAf,EAA8BD,IAAI,CAAChD,KAAnC,EAAvB,GACAkD,SAHqB;AAAA,GAAvB;;AAMA,MAAMC,SAAS,GAAG,SAAZA,SAAY,CAACC,WAAD;AAAA,WAAuBlC,KAAK,IAAIlB,KAAK,CAACsB,KAAf,GAAuB8B,WAAvB,GAAqC7C,KAAK,CAACsC,KAAN,CAAYQ,gBAAxE;AAAA,GAAlB;;AACA,MAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,IAAD,EAAqDC,SAArD;AAAA,WACrB,OAAOD,IAAP,KAAgB,QAAhB,GAA2B,eAAC,UAAD,gCAAUC,SAAV;AAAqB,MAAA,KAAK,EAAEL,SAAS,EAArC;AAAyC,MAAA,GAAG;AAA5C,QAA8CI,IAA9C,CAA3B,GACA,OAAOA,IAAP,KAAgB,UAAhB,GAA6BA,IAAI,+BAAMvD,KAAN;AAAakB,MAAAA,KAAK,EAALA;AAAb,OAAjC,GACA,+BAAMuC,cAAN,CAAqBF,IAArB,IAA6B,eAAC,IAAD,CAAM,IAAN,gCAAeC,SAAf,EAA8BD,IAAI,CAACvD,KAAnC;AAA0C,MAAA,KAAK,EAAEmD,SAAS,CAACI,IAAI,CAACvD,KAAL,CAAW0D,KAAZ;AAA1D,OAA7B,GACAR,SAJqB;AAAA,GAAvB;;AAOA,MAAMtB,SAAS,GAAGmB,cAAc,CAC9BP,SAAS,CAACmB,SAAV,GAAsB,eAAC,SAAD,CAAW,SAAX,OAAtB,GAAgD3D,KAAK,CAAC4B,SADxB,EAE9BJ,SAAS,iCAAQgB,SAAS,CAACxC,KAAlB;AAAyB4D,IAAAA,OAAO,EAAEtB;AAAlC,OAAkDE,SAAS,CAACxC,KAFvC,CAAhC;AAKA,MAAM6D,YAAY,IAAM7D,KAAK,CAAC0B,QAAN,GAAiB,UAAjB,GAA8B,EAApC,WAA0CR,KAAK,GAAG,OAAH,GAAa,EAA5D,CAAlB;AAEA,SACE;AACA;AAAO,MAAA,GAAG,EAAE0B,UAAZ;AAAwB,oBAAYiB,YAApC;AAAkD,MAAA,WAAW,EAAE5B;AAA/D,OACGjC,KAAK,CAAC8D,UAAN,IAAoBf,cAAc,CAAC/C,KAAK,CAAC8D,UAAP,EAAmBvB,UAAU,CAACvC,KAA9B,CADrC,EAEE;AAAK,MAAA,GAAG,EAAE8C;AAAV,OACG9C,KAAK,CAAC+D,MAAN,IAAgBT,cAAc,CAACtD,KAAK,CAAC+D,MAAP,EAAerB,MAAM,CAAC1C,KAAtB,CADjC,EAEGgB,UAAU,+BACNhB,KADM;AAETuB,MAAAA,QAAQ,EAARA,QAFS;AAGTyC,MAAAA,QAAQ,EAAEvC,OAAO,CAACzB,KAAK,CAACiE,OAAP,CAHR;AAITC,MAAAA,GAAG,EAAEnD,MAJI;AAKTN,MAAAA,OAAO,EAAEsB,WALA;AAMTrB,MAAAA,MAAM,EAAEsB;AANC,OAFb,EAUGhC,KAAK,CAACiE,OAAN,IAAiBX,cAAc,CAACtD,KAAK,CAACiE,OAAP,EAAgBtB,OAAO,CAAC3C,KAAxB,CAVlC,CAFF,EAcG4B,SAdH;AAFF;AAoBD,CA/EoB,CAAd","sourcesContent":["import React, { isValidElement, useState } from 'react'\nimport { useUncontrolledInputHook, useSyntheticChange } from '../../hooks/'\nimport { foldThemeParams, createClassName } from '../../styled-system/'\nimport { uiComponent } from '../../theme/'\nimport { clearValue, invokeAll } from '../../utils/'\nimport { IconProps } from '../Icon/'\nimport { Text, TextProps } from '../Text/'\nimport { InputProps } from './contract'\nimport { InputCore } from './InputCore'\nimport { inputTheme } from './theme'\n\nconst inputClassName = createClassName<InputProps, typeof inputTheme>(\n  (themeStyle, props) => ({\n    display: 'flex',\n    width: 1,\n    ...themeStyle,\n    ...props,\n  }),\n  (textRules) => (`\n    position: relative;\n    font-family: inherit;\n    align-items: center;\n\n    ${textRules}\n  `)\n)\n\nconst inputFieldClassName = createClassName<InputProps, typeof inputTheme>(\n  (themeStyle) => ({\n    display: 'flex',\n    valign: 'middle',\n    grow: true,\n    ...themeStyle,\n  }),\n  (textRules) => (`\n    height: 100%;\n    overflow: hidden;\n\n    ${textRules}\n  `)\n)\n\nexport const Input = uiComponent('Input', inputTheme)<InputProps, HTMLInputElement>((\n  { onFocus, onBlur, mask, ...props },\n  { theme, tokens },\n  [inputRef, setRef]\n) => {\n  const renderCore = props.renderCore || (p => <InputCore {...p} />)\n  const [focus, setFocus] = useState(false)\n  const [safeValue, safeOnChange] = useUncontrolledInputHook(props)\n  const [value, onChange] = useSyntheticChange(safeValue, safeOnChange, mask)\n  const clearable = Boolean(\n    value &&\n    !props.disabled && !props.readOnly &&\n    (props.clearable === 'always' || props.clearable && focus))\n\n  props = {\n    ...props,\n    value,\n    clearable,\n    // apply iconAfter theme if clearable\n    iconAfter: clearable ? true : props.iconAfter,\n    placeholder: inputTheme.deletePlaceholderOnFocus && focus ? '' : props.placeholder,\n  }\n\n  const handleFocus = invokeAll(() => setFocus(true), onFocus)\n  const handleBlur = invokeAll(() => setFocus(false), onBlur)\n\n  // Отменяем моргание фокуса при повторных кликах внутри контейнера с инпутом\n  // Проверка нужна что бы не блокировать выделениие в самом инпуте\n  const handlePreventBlur = (event: React.MouseEvent<HTMLElement>) => {\n    if (event.target !== inputRef.current) event.preventDefault()\n  }\n\n  const handleClear = () => clearValue(inputRef.current)\n\n  const { Input, IconBefore, IconAfter, InputField, Prefix, Postfix } = foldThemeParams(props, theme)\n  const inputStyle = inputClassName(props, tokens, Input.style)\n  const inputFieldStyle = inputFieldClassName(props, tokens, InputField.style)\n\n  const renderIconSlot = (icon: InputProps['iconBefore'] | InputProps['iconAfter'], iconProps: IconProps) => (\n    typeof icon === 'function' ? icon({ ...props, iconProps, focus, handleClear }) :\n    isValidElement(icon) ? <icon.type {...iconProps} {...icon.props} /> :\n    undefined\n  )\n\n  const textColor = (activeColor?: any) => focus || props.value ? activeColor : Input.style.placeholderColor\n  const renderTextSlot = (text: InputProps['prefix'] | InputProps['postfix'], textProps: TextProps) => (\n    typeof text === 'string' ? <Text {...textProps} color={textColor()} pre>{text}</Text> :\n    typeof text === 'function' ? text({ ...props, focus }) :\n    React.isValidElement(text) ? <text.type {...textProps} {...text.props} color={textColor(text.props.color)} /> :\n    undefined\n  )\n\n  const iconAfter = renderIconSlot(\n    IconAfter.component ? <IconAfter.component /> : props.iconAfter,\n    clearable ? { ...IconAfter.props, onClick: handleClear } : IconAfter.props\n  )\n\n  const elementState = `${props.disabled ? 'disabled' : ''} ${focus ? 'focus' : ''}`\n\n  return (\n    // eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions\n    <label css={inputStyle} data-state={elementState} onMouseDown={handlePreventBlur}>\n      {props.iconBefore && renderIconSlot(props.iconBefore, IconBefore.props)}\n      <div css={inputFieldStyle}>\n        {props.prefix && renderTextSlot(props.prefix, Prefix.props)}\n        {renderCore({\n          ...props,\n          onChange,\n          autoSize: Boolean(props.postfix),\n          ref: setRef,\n          onFocus: handleFocus,\n          onBlur: handleBlur,\n        })}\n        {props.postfix && renderTextSlot(props.postfix, Postfix.props)}\n      </div>\n      {iconAfter}\n\n    </label>\n  )\n})\n"],"file":"Input.js"}