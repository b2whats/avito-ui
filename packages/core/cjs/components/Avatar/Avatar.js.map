{"version":3,"sources":["../../../src/components/Avatar/Avatar.tsx"],"names":["avatarClassName","themeStyle","props","display","position","shrink","grow","textRules","imageClassName","css","Avatar","avatarTheme","theme","tokens","_","setRef","src","isFallback","setFallback","onError","Wrapper","Badge","Fallback","Tag","as","alt","aria","role","onClick","disabled","renderFallback","children","fallbackProps","Children","only","toUpperCase","style","badge"],"mappings":"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","sourcesContent":["import React, { Children, ReactNode, useState, useEffect, isValidElement } from 'react'\nimport { foldThemeParams, createClassName, css } from '../../styled-system'\nimport { uiComponent } from '../../theme'\nimport { filterProps, omit } from '../../utils'\nimport { IconProps } from '../Icon'\nimport { Text } from '../Text'\nimport { AvatarProps } from './contract'\nimport { avatarTheme } from './theme'\n\nconst avatarClassName = createClassName<AvatarProps, typeof avatarTheme>(\n  (themeStyle, props) => ({\n    display: 'inline-flex',\n    position: 'relative',\n    shrink: false,\n    grow: false,\n    ...themeStyle,\n    ...props,\n  }),\n  (textRules) => (`\n    user-select: none;\n    & *:nth-child(2) {\n      /* position badge above overlay */\n      z-index: 1;\n    }\n    ${textRules}\n  `)\n)\nconst imageClassName = css`\n  border-radius: inherit;\n  max-width: 100%;\n  max-height: 100%;\n`\n\nexport const Avatar = uiComponent('Avatar', avatarTheme)<\n  AvatarProps,\n  HTMLImageElement\n>((props, { theme, tokens }, [_, setRef]) => {\n  const [isFallback, setFallback] = useState(props.src == null)\n  const onError = () => setFallback(true)\n  useEffect(() => setFallback(props.src == null), [props.src])\n\n  const { Wrapper, Badge, Fallback } = foldThemeParams({ ...props, isFallback }, theme)\n\n  const Tag = props.as || 'span'\n  const alt = props.alt || 'Пользователь'\n  const aria = {\n    role: props.onClick ? 'button' : 'img',\n    'aria-disabled': props.disabled,\n  }\n  const renderFallback = (children: ReactNode, fallbackProps: IconProps) => (\n    isValidElement(children) ? <children.type {...fallbackProps} {...children.props} /> :\n    typeof children === 'function' ? Children.only(children(fallbackProps)) :\n    typeof children === 'string' ? <Text crop>{children}</Text> :\n    typeof props.alt === 'string' ? <Text crop>{props.alt[0].toUpperCase()}</Text> :\n    <Fallback.component {...fallbackProps} />)\n\n  // FIXME put onClick on img / fallback for easier badge clicks?\n  return (\n    <Tag css={avatarClassName(props, tokens, Wrapper.style)} {...aria} {...filterProps(omit(props, 'src'))}>\n      { isFallback\n        ? renderFallback(props.children, Fallback.props)\n        : <img css={imageClassName} draggable='false' src={props.src} onError={onError} alt={alt} /> }\n      { props.badge &&\n        <props.badge.type {...Badge.props} {...props.badge.props} /> }\n    </Tag>\n  )\n})\n"],"file":"Avatar.js"}